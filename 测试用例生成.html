<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åŸºäºLLMçš„æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå·¥å…·</title>
  <!-- å¼•å…¥ Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- å¼•å…¥ Font Awesome å›¾æ ‡ -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- é…ç½® Tailwind è‡ªå®šä¹‰ä¸»é¢˜ -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#165DFF',
            secondary: '#4080FF',
            neutral: '#F5F7FA',
            dark: '#1D2129',
            success: '#00B42A',
            warning: '#FF7D00',
            danger: '#F53F3F',
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  <!-- è‡ªå®šä¹‰å·¥å…·ç±» -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .card-hover {
        @apply transition-all duration-300 hover:shadow-lg hover:-translate-y-1;
      }
      .btn-primary {
        @apply bg-primary text-white px-4 py-2 rounded-lg font-medium transition-all duration-300 hover:bg-primary/90 active:scale-95 focus:outline-none focus:ring-2 focus:ring-primary/50;
      }
      .btn-secondary {
        @apply bg-white text-primary border border-primary px-4 py-2 rounded-lg font-medium transition-all duration-300 hover:bg-primary/5 active:scale-95 focus:outline-none focus:ring-2 focus:ring-primary/50;
      }
    }
  </style>
  <style>
    /* å…¨å±€æ ·å¼ */
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background-color: #F9FAFC;
    }
    
    /* æ»šåŠ¨æ¡ç¾åŒ– */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #a1a1a1;
    }
    
    /* åŠ¨ç”»æ•ˆæœ */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .fade-in {
      animation: fadeIn 0.5s ease-in-out;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    .pulse-animation {
      animation: pulse 1.5s infinite;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <header class="bg-white shadow-sm sticky top-0 z-50">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <i class="fa fa-flask text-primary text-2xl"></i>
        <h1 class="text-xl md:text-2xl font-bold text-dark">PRD æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå·¥å…·</h1>
      </div>
      <div class="flex items-center space-x-3">
        <button class="text-gray-600 hover:text-primary transition-colors" title="å¸®åŠ©æ–‡æ¡£">
          <i class="fa fa-question-circle text-lg"></i>
        </button>
        <button class="text-gray-600 hover:text-primary transition-colors" title="å…³äº">
          <i class="fa fa-info-circle text-lg"></i>
        </button>
      </div>
    </div>
  </header>

  <!-- ä¸»è¦å†…å®¹åŒº -->
  <main class="flex-grow container mx-auto px-4 py-6 md:py-10">
    <!-- ä»‹ç»å¡ç‰‡ -->
    <div class="bg-white rounded-xl shadow-sm p-4 md:p-6 mb-8 fade-in">
      <div class="flex items-start">
        <div class="bg-primary/10 p-3 rounded-lg mr-4">
          <i class="fa fa-lightbulb-o text-primary text-xl"></i>
        </div>
        <div>
          <h2 class="text-lg md:text-xl font-semibold text-dark mb-2">æ™ºèƒ½æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ</h2>
          <p class="text-gray-600">è¾“å…¥ä½ çš„äº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰å†…å®¹ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–çš„æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒ…å«æ¨¡å—ã€æ ‡é¢˜ã€å‰ç½®æ¡ä»¶ã€æµ‹è¯•æ­¥éª¤å’Œé¢„æœŸç»“æœã€‚</p>
        </div>
      </div>
    </div>

    <!-- è¾“å…¥å’Œç»“æœåŒºåŸŸ -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
      <!-- PRD è¾“å…¥åŒºåŸŸ -->
      <div class="bg-white rounded-xl shadow-sm overflow-hidden card-hover">
        <div class="bg-primary/5 px-4 py-3 border-b border-gray-100 flex items-center">
          <i class="fa fa-file-text-o text-primary mr-2"></i>
          <h3 class="font-semibold text-dark">PRD å†…å®¹è¾“å…¥</h3>
        </div>
        <div class="p-4">
          <div class="mb-4">
            <label for="prd-content" class="block text-sm font-medium text-gray-700 mb-1">è¯·è¾“å…¥ PRD è¯¦ç»†æè¿°</label>
            <textarea 
              id="prd-content" 
              class="w-full h-64 md:h-80 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all resize-none"
              placeholder="ä¾‹å¦‚ï¼šç”¨æˆ·å¯ä»¥ç™»å½•ç³»ç»Ÿï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼ŒéªŒè¯é€šè¿‡åè·³è½¬åˆ°é¦–é¡µã€‚ç”¨æˆ·åé•¿åº¦ä¸º6-20ä½ï¼Œå¯†ç é•¿åº¦ä¸º8-16ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—..."></textarea>
            <div class="flex justify-between text-xs text-gray-500 mt-1">
              <span id="char-count">0 å­—ç¬¦</span>
              <span>æ”¯æŒ Markdown æ ¼å¼</span>
            </div>
          </div>
          <div class="flex flex-wrap gap-3">
            <button id="generate-btn" class="btn-primary flex items-center">
              <i class="fa fa-magic mr-2"></i> ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
            </button>
            <button id="clear-btn" class="btn-secondary flex items-center">
              <i class="fa fa-eraser mr-2"></i> æ¸…ç©º
            </button>
          </div>
        </div>
      </div>

      <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
      <div class="bg-white rounded-xl shadow-sm overflow-hidden card-hover">
        <div class="bg-primary/5 px-4 py-3 border-b border-gray-100 flex justify-between items-center">
          <div class="flex items-center">
            <i class="fa fa-list-alt text-primary mr-2"></i>
            <h3 class="font-semibold text-dark">ç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹</h3>
          </div>
          <div class="flex space-x-2">
            <button id="copy-btn" class="text-gray-600 hover:text-primary transition-colors px-2 py-1 rounded" title="å¤åˆ¶ç»“æœ">
              <i class="fa fa-copy"></i>
            </button>
            <button id="export-btn" class="text-gray-600 hover:text-primary transition-colors px-2 py-1 rounded" title="å¯¼å‡ºä¸ºJSON">
              <i class="fa fa-download"></i>
            </button>
          </div>
        </div>
        <div class="p-4">
          <div id="result-empty" class="h-64 md:h-80 flex flex-col items-center justify-center text-gray-400">
            <i class="fa fa-file-text-o text-4xl mb-3"></i>
            <p>æµ‹è¯•ç”¨ä¾‹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
            <p class="text-xs mt-1">ç‚¹å‡»"ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹"æŒ‰é’®å¼€å§‹</p>
          </div>
          
          <div id="result-loading" class="h-64 md:h-80 flex flex-col items-center justify-center text-gray-500 hidden">
            <div class="w-10 h-10 border-4 border-primary/30 border-t-primary rounded-full animate-spin mb-3"></div>
            <p>æ­£åœ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹...</p>
            <p class="text-xs mt-1">è¯·ç¨å€™ï¼Œè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿ</p>
          </div>
          
          <div id="result-error" class="h-64 md:h-80 flex flex-col items-center justify-center text-danger hidden">
            <i class="fa fa-exclamation-circle text-4xl mb-3"></i>
            <p id="error-message" class="text-center px-4">ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•</p>
            <button id="retry-btn" class="btn-primary mt-4">
              <i class="fa fa-refresh mr-2"></i> é‡è¯•
            </button>
          </div>
          
          <div id="result-success" class="h-64 md:h-80 overflow-auto hidden">
            <div class="space-y-4" id="test-cases-container">
              <!-- æµ‹è¯•ç”¨ä¾‹å°†åŠ¨æ€æ’å…¥è¿™é‡Œ -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- æµ‹è¯•ç”¨ä¾‹é¢„è§ˆå¡ç‰‡ -->
    <div class="bg-white rounded-xl shadow-sm p-4 md:p-6 mb-8 fade-in">
      <h3 class="text-lg font-semibold text-dark mb-4 flex items-center">
        <i class="fa fa-eye text-primary mr-2"></i> æµ‹è¯•ç”¨ä¾‹æ ¼å¼é¢„è§ˆ
      </h3>
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead>
            <tr>
              <th class="px-3 py-2 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tl-lg">æ¨¡å—</th>
              <th class="px-3 py-2 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æµ‹è¯•æ ‡é¢˜</th>
              <th class="px-3 py-2 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å‰ç½®æ¡ä»¶</th>
              <th class="px-3 py-2 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æµ‹è¯•æ­¥éª¤</th>
              <th class="px-3 py-2 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tr-lg">é¢„æœŸç»“æœ</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            <tr>
              <td class="px-3 py-2 text-sm text-gray-700">ç”¨æˆ·ç™»å½•</td>
              <td class="px-3 py-2 text-sm text-gray-700">æ­£ç¡®ç”¨æˆ·åå¯†ç ç™»å½•</td>
              <td class="px-3 py-2 text-sm text-gray-700">1. ç³»ç»Ÿå·²éƒ¨ç½²å®Œæˆ<br>2. å­˜åœ¨æœ‰æ•ˆç”¨æˆ·è´¦å·</td>
              <td class="px-3 py-2 text-sm text-gray-700">1. æ‰“å¼€ç™»å½•é¡µé¢<br>2. è¾“å…¥æ­£ç¡®ç”¨æˆ·å<br>3. è¾“å…¥æ­£ç¡®å¯†ç <br>4. ç‚¹å‡»ç™»å½•æŒ‰é’®</td>
              <td class="px-3 py-2 text-sm text-gray-700">æˆåŠŸç™»å½•ç³»ç»Ÿï¼Œè·³è½¬åˆ°é¦–é¡µ</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- é¡µè„š -->
  <footer class="bg-dark text-white py-6">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-4 md:mb-0">
          <p class="text-gray-400 text-sm">Â© 2025 PRD æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå·¥å…·. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
        </div>
        <div class="flex space-x-4">
          <a href="#" class="text-gray-400 hover:text-white transition-colors text-sm">éšç§æ”¿ç­–</a>
          <a href="#" class="text-gray-400 hover:text-white transition-colors text-sm">ä½¿ç”¨æ¡æ¬¾</a>
          <a href="#" class="text-gray-400 hover:text-white transition-colors text-sm">è”ç³»æˆ‘ä»¬</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- æç¤ºæ¡†ç»„ä»¶ -->
  <div id="toast" class="fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center z-50">
    <i id="toast-icon" class="mr-2"></i>
    <span id="toast-message"></span>
  </div>

  <script>
    // DOM å…ƒç´ 
    const prdContentEl = document.getElementById('prd-content');
    const charCountEl = document.getElementById('char-count');
    const generateBtn = document.getElementById('generate-btn');
    const clearBtn = document.getElementById('clear-btn');
    const copyBtn = document.getElementById('copy-btn');
    const exportBtn = document.getElementById('export-btn');
    const retryBtn = document.getElementById('retry-btn');
    const resultEmptyEl = document.getElementById('result-empty');
    const resultLoadingEl = document.getElementById('result-loading');
    const resultErrorEl = document.getElementById('result-error');
    const resultSuccessEl = document.getElementById('result-success');
    const errorMessageEl = document.getElementById('error-message');
    const testCasesContainerEl = document.getElementById('test-cases-container');
    const toastEl = document.getElementById('toast');
    const toastIconEl = document.getElementById('toast-icon');
    const toastMessageEl = document.getElementById('toast-message');

    // åç«¯ API åœ°å€ï¼ˆæ ¹æ®å®é™…éƒ¨ç½²æƒ…å†µä¿®æ”¹ï¼‰
    const API_URL = 'http://localhost:8000/generate';

    // å­—ç¬¦è®¡æ•°
    prdContentEl.addEventListener('input', () => {
      const length = prdContentEl.value.length;
      charCountEl.textContent = `${length} å­—ç¬¦`;
    });

    // æ¸…ç©ºè¾“å…¥
    clearBtn.addEventListener('click', () => {
      prdContentEl.value = '';
      charCountEl.textContent = '0 å­—ç¬¦';
      showToast('å·²æ¸…ç©ºè¾“å…¥', 'info');
    });

    // ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
    // ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
    generateBtn.addEventListener('click', async () => {
      const prdContent = prdContentEl.value.trim();

      // éªŒè¯è¾“å…¥
      if (!prdContent) {
        showToast('è¯·è¾“å…¥ PRD å†…å®¹', 'warning');
        return;
      }

      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      switchResultView('loading');

      try {
        // è°ƒç”¨åç«¯ API
        const response = await fetch(API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ content: prdContent }),
        });

        const data = await response.json();

        // console.log("åç«¯è¿”å›çš„å®Œæ•´æ•°æ®:", data); // å»ºè®®å¼€å¯è¿™ä¸€è¡Œè°ƒè¯•ï¼Œæ–¹ä¾¿åœ¨ F12 æ§åˆ¶å°æŸ¥çœ‹ç»“æ„

        if (data.status === 'success') {
          // ğŸŸ¢ ã€å…³é”®ä¿®æ”¹ç‚¹ã€‘: è¿™é‡Œè¦å– data.data.cases
          const casesList = data.data.cases || [];

          // æ˜¾ç¤ºæˆåŠŸç»“æœ
          renderTestCases(casesList);
          switchResultView('success');
          showToast(`æˆåŠŸç”Ÿæˆ ${casesList.length} ä¸ªæµ‹è¯•ç”¨ä¾‹`, 'success');
        } else {
          // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
          errorMessageEl.textContent = data.message || 'ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹å¤±è´¥ï¼Œè¯·é‡è¯•';
          switchResultView('error');
          showToast('ç”Ÿæˆå¤±è´¥ï¼š' + (data.message || 'æœªçŸ¥é”™è¯¯'), 'error');
        }
      } catch (error) {
        console.error('ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹å‡ºé”™ï¼š', error);
        errorMessageEl.textContent = 'ç½‘ç»œé”™è¯¯æˆ–æœåŠ¡å™¨æœªå“åº”ï¼Œè¯·æ£€æŸ¥è¿æ¥åé‡è¯•';
        switchResultView('error');
        showToast('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥è¿æ¥', 'error');
      }
    });

    // é‡è¯•ç”Ÿæˆ
    retryBtn.addEventListener('click', () => {
      generateBtn.click();
    });

    // å¤åˆ¶ç»“æœ
    copyBtn.addEventListener('click', () => {
      if (resultSuccessEl.classList.contains('hidden')) {
        showToast('æš‚æ— ç»“æœå¯å¤åˆ¶', 'warning');
        return;
      }
      
      // è·å–æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹æ•°æ®
      const testCases = Array.from(testCasesContainerEl.children).map(card => {
        return {
          module: card.querySelector('[data-field="module"]').textContent.trim(),
          title: card.querySelector('[data-field="title"]').textContent.trim(),
          pre_condition: card.querySelector('[data-field="pre_condition"]').textContent.trim(),
          steps: Array.from(card.querySelectorAll('[data-field="steps"] li'))
            .map(li => li.textContent.trim()),
          expected_result: card.querySelector('[data-field="expected_result"]').textContent.trim()
        };
      });
      
      // å¤åˆ¶åˆ°å‰ªè´´æ¿
      navigator.clipboard.writeText(JSON.stringify(testCases, null, 2))
        .then(() => {
          showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
        })
        .catch(err => {
          console.error('å¤åˆ¶å¤±è´¥ï¼š', err);
          showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
        });
    });

    // å¯¼å‡ºç»“æœ
    exportBtn.addEventListener('click', () => {
      if (resultSuccessEl.classList.contains('hidden')) {
        showToast('æš‚æ— ç»“æœå¯å¯¼å‡º', 'warning');
        return;
      }
      
      // è·å–æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹æ•°æ®
      const testCases = Array.from(testCasesContainerEl.children).map(card => {
        return {
          module: card.querySelector('[data-field="module"]').textContent.trim(),
          title: card.querySelector('[data-field="title"]').textContent.trim(),
          pre_condition: card.querySelector('[data-field="pre_condition"]').textContent.trim(),
          steps: Array.from(card.querySelectorAll('[data-field="steps"] li'))
            .map(li => li.textContent.trim()),
          expected_result: card.querySelector('[data-field="expected_result"]').textContent.trim()
        };
      });
      
      // åˆ›å»ºä¸‹è½½é“¾æ¥
      const blob = new Blob([JSON.stringify(testCases, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `æµ‹è¯•ç”¨ä¾‹_${new Date().toLocaleString().replace(/[/:\s]/g, '-')}.json`;
      document.body.appendChild(a);
      a.click();
      
      // æ¸…ç†
      setTimeout(() => {
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }, 0);
      
      showToast('å¯¼å‡ºæˆåŠŸ', 'success');
    });

    // åˆ‡æ¢ç»“æœè§†å›¾
    function switchResultView(view) {
      // éšè—æ‰€æœ‰è§†å›¾
      resultEmptyEl.classList.add('hidden');
      resultLoadingEl.classList.add('hidden');
      resultErrorEl.classList.add('hidden');
      resultSuccessEl.classList.add('hidden');
      
      // æ˜¾ç¤ºæŒ‡å®šè§†å›¾
      switch(view) {
        case 'empty':
          resultEmptyEl.classList.remove('hidden');
          break;
        case 'loading':
          resultLoadingEl.classList.remove('hidden');
          break;
        case 'error':
          resultErrorEl.classList.remove('hidden');
          break;
        case 'success':
          resultSuccessEl.classList.remove('hidden');
          break;
      }
    }

    // æ¸²æŸ“æµ‹è¯•ç”¨ä¾‹
    function renderTestCases(testCases) {
      // æ¸…ç©ºå®¹å™¨
      testCasesContainerEl.innerHTML = '';
      
      if (!Array.isArray(testCases) || testCases.length === 0) {
        testCasesContainerEl.innerHTML = '<div class="text-center text-gray-400 py-8">æ²¡æœ‰ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹</div>';
        return;
      }
      
      // æ¸²æŸ“æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹
      testCases.forEach((testCase, index) => {
        const card = document.createElement('div');
        card.className = 'border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow';
        card.innerHTML = `
          <div class="flex items-center justify-between mb-3">
            <h4 class="font-semibold text-dark flex items-center">
              <span class="bg-primary/10 text-primary text-xs font-medium px-2 py-1 rounded mr-2">ç”¨ä¾‹ ${index + 1}</span>
              <span data-field="title">${escapeHtml(testCase.title || 'æœªå‘½åæµ‹è¯•ç”¨ä¾‹')}</span>
            </h4>
            <span class="bg-secondary/10 text-secondary text-xs font-medium px-2 py-1 rounded" data-field="module">${escapeHtml(testCase.module || 'æœªåˆ†ç±»')}</span>
          </div>
          
          <div class="space-y-3 text-sm">
            <div>
              <label class="block text-gray-500 mb-1 flex items-center">
                <i class="fa fa-check-circle text-gray-400 mr-1"></i> å‰ç½®æ¡ä»¶
              </label>
              <div class="pl-6 text-gray-700" data-field="pre_condition">${escapeHtml(testCase.pre_condition || 'æ— ')}</div>
            </div>
            
            <div>
              <label class="block text-gray-500 mb-1 flex items-center">
                <i class="fa fa-list-ol text-gray-400 mr-1"></i> æµ‹è¯•æ­¥éª¤
              </label>
              <ul class="pl-6 text-gray-700 list-decimal space-y-1" data-field="steps">
                ${Array.isArray(testCase.steps) && testCase.steps.length > 0 
                  ? testCase.steps.map(step => `<li>${escapeHtml(step)}</li>`).join('') 
                  : '<li>æ— </li>'}
              </ul>
            </div>
            
            <div>
              <label class="block text-gray-500 mb-1 flex items-center">
                <i class="fa fa-check-square-o text-gray-400 mr-1"></i> é¢„æœŸç»“æœ
              </label>
              <div class="pl-6 text-gray-700" data-field="expected_result">${escapeHtml(testCase.expected_result || 'æ— ')}</div>
            </div>
          </div>
        `;
        testCasesContainerEl.appendChild(card);
      });
    }

    // æ˜¾ç¤ºæç¤ºæ¡†
    function showToast(message, type = 'info') {
      // è®¾ç½®å›¾æ ‡å’Œé¢œè‰²
      switch(type) {
        case 'success':
          toastIconEl.className = 'fa fa-check-circle text-success';
          toastEl.className = 'fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg transform translate-y-0 opacity-100 transition-all duration-300 flex items-center z-50 bg-success/10 text-success border border-success/30';
          break;
        case 'error':
          toastIconEl.className = 'fa fa-exclamation-circle text-danger';
          toastEl.className = 'fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg transform translate-y-0 opacity-100 transition-all duration-300 flex items-center z-50 bg-danger/10 text-danger border border-danger/30';
          break;
        case 'warning':
          toastIconEl.className = 'fa fa-exclamation-triangle text-warning';
          toastEl.className = 'fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg transform translate-y-0 opacity-100 transition-all duration-300 flex items-center z-50 bg-warning/10 text-warning border border-warning/30';
          break;
        case 'info':
        default:
          toastIconEl.className = 'fa fa-info-circle text-primary';
          toastEl.className = 'fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg transform translate-y-0 opacity-100 transition-all duration-300 flex items-center z-50 bg-primary/10 text-primary border border-primary/30';
          break;
      }
      
      // è®¾ç½®æ¶ˆæ¯
      toastMessageEl.textContent = message;
      
      // 3ç§’åéšè—
      setTimeout(() => {
        toastEl.className = 'fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center z-50';
      }, 3000);
    }

    // HTML è½¬ä¹‰
    function escapeHtml(unsafe) {
      if (!unsafe) return '';
      return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;")
        .replace(/\n/g, "<br>");
    }

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      switchResultView('empty');
      // ç¤ºä¾‹ PRD å†…å®¹ï¼ˆå¯é€‰ï¼‰
      prdContentEl.value = `PRD å†…å®¹ï¼šç”¨æˆ·ç™»å½•åŠŸèƒ½
1. åŠŸèƒ½æè¿°ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡ç”¨æˆ·åå’Œå¯†ç ç™»å½•ç³»ç»Ÿ
2. è¾“å…¥é™åˆ¶ï¼š
   - ç”¨æˆ·åï¼š6-20ä½å­—ç¬¦ï¼Œæ”¯æŒå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
   - å¯†ç ï¼š8-16ä½å­—ç¬¦ï¼Œå¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—
3. æ“ä½œæµç¨‹ï¼š
   - æ‰“å¼€ç™»å½•é¡µé¢
   - è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
   - ç‚¹å‡»ç™»å½•æŒ‰é’®
   - éªŒè¯é€šè¿‡åè·³è½¬åˆ°é¦–é¡µ
4. é”™è¯¯å¤„ç†ï¼š
   - ç”¨æˆ·åä¸å­˜åœ¨ï¼šæç¤º"ç”¨æˆ·åä¸å­˜åœ¨"
   - å¯†ç é”™è¯¯ï¼šæç¤º"å¯†ç é”™è¯¯"
   - å­—æ®µä¸ºç©ºï¼šæç¤º"è¯·è¾“å…¥ç”¨æˆ·å/å¯†ç "
   - æ ¼å¼ä¸æ­£ç¡®ï¼šæç¤ºå¯¹åº”çš„æ ¼å¼é”™è¯¯ä¿¡æ¯`;
      prdContentEl.dispatchEvent(new Event('input'));
    });
  </script>
</body>
</html>